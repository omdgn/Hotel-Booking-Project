import{a as s,b as n,e as p,g as m,h as a,i as c,k as f,m as u,pa as y,q as d,t as g}from"./chunk-47E5XFJY.js";var o=[{id:"user-1",email:"ahmet.yilmaz@email.com",password:"password123!",firstName:"Ahmet",lastName:"Y\u0131lmaz",city:"Istanbul",country:"Turkey",photoUrl:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80",registrationDate:"2024-01-15",isActive:!0},{id:"user-2",email:"fatma.kaya@email.com",password:"mypass456@",firstName:"Fatma",lastName:"Kaya",city:"Ankara",country:"Turkey",photoUrl:"https://images.unsplash.com/photo-1494790108755-2616b612b742?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80",registrationDate:"2024-02-20",isActive:!0},{id:"user-3",email:"mehmet.oz@email.com",password:"secure789#",firstName:"Mehmet",lastName:"\xD6z",city:"Izmir",country:"Turkey",registrationDate:"2024-03-10",isActive:!0},{id:"user-4",email:"zeynep.demir@email.com",password:"strong321$",firstName:"Zeynep",lastName:"Demir",city:"Antalya",country:"Turkey",photoUrl:"https://images.unsplash.com/photo-1438761681033-6461ffad8d80?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80",registrationDate:"2024-04-05",isActive:!0},{id:"user-5",email:"can.arslan@email.com",password:"password999&",firstName:"Can",lastName:"Arslan",city:"Bursa",country:"Turkey",registrationDate:"2024-05-12",isActive:!0},{id:"user-6",email:"elif.yildiz@email.com",password:"elif2024!",firstName:"Elif",lastName:"Y\u0131ld\u0131z",city:"Istanbul",country:"Turkey",photoUrl:"https://images.unsplash.com/photo-1544005313-94ddf0286df2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80",registrationDate:"2024-06-18",isActive:!0},{id:"user-7",email:"oguz.kaan@email.com",password:"kaan123@",firstName:"O\u011Fuz",lastName:"Kaan",city:"Ankara",country:"Turkey",registrationDate:"2024-07-22",isActive:!0},{id:"user-8",email:"selin.ozkan@email.com",password:"selin456#",firstName:"Selin",lastName:"\xD6zkan",city:"Nevsehir",country:"Turkey",photoUrl:"https://images.unsplash.com/photo-1489424731084-a5d8b219a5bb?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80",registrationDate:"2024-08-30",isActive:!0},{id:"google-user-1",email:"test.google@gmail.com",password:"google-mock-password",firstName:"Google",lastName:"Test User",city:"Istanbul",country:"Turkey",photoUrl:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80",registrationDate:"2024-01-01",isActive:!0}];var S=(()=>{class l{constructor(t){this.http=t,this.currentUserSubject=new p(null),this.currentUser$=this.currentUserSubject.asObservable(),this.STORAGE_KEY="currentUser",this.TOKEN_KEY="authToken",this.API_URL="https://web-finalproject-ub2x.onrender.com",this.checkStoredUser()}checkStoredUser(){let t=localStorage.getItem(this.STORAGE_KEY);if(t)try{let i=JSON.parse(t);this.currentUserSubject.next(i)}catch{localStorage.removeItem(this.STORAGE_KEY)}}login(t){let i={email:t.email,password:t.password};return this.http.post(`${this.API_URL}/auth/login`,i).pipe(c(e=>{localStorage.setItem(this.TOKEN_KEY,e.token);let r=n(s({},e.user),{firstName:e.user.name?.split(" ")[0]||"",lastName:e.user.name?.split(" ").slice(1).join(" ")||"",photoUrl:e.user.photo_url,registrationDate:new Date().toISOString().split("T")[0],isActive:!0});return this.setCurrentUser(r),r}),f(e=>{console.error("Login error:",e);let r="Giri\u015F s\u0131ras\u0131nda bir hata olu\u015Ftu";return e.error?.message?r=e.error.message:e.status===401?r="Ge\xE7ersiz email veya \u015Fifre":e.status===400?r="Ge\xE7ersiz giri\u015F bilgileri":e.status===404&&(r="Kullan\u0131c\u0131 bulunamad\u0131"),a(()=>new Error(r))}))}loginWithGoogle(){let t=o.find(i=>i.id==="google-user-1");if(t){let i=n(s({},t),{password:""});return this.setCurrentUser(i),m(i).pipe(u(1e3))}else return a(()=>new Error("Google login failed")).pipe(u(1e3))}register(t){let i={email:t.email,password:t.password,name:t.firstName&&t.lastName?`${t.firstName} ${t.lastName}`:t.name||"",country:t.country,city:t.city,photo_url:t.photoUrl||t.photo_url||""};return this.http.post(`${this.API_URL}/auth/register`,i).pipe(c(e=>{localStorage.setItem(this.TOKEN_KEY,e.token);let r=n(s({},e.user),{firstName:e.user.name?.split(" ")[0]||"",lastName:e.user.name?.split(" ").slice(1).join(" ")||"",photoUrl:e.user.photo_url,registrationDate:new Date().toISOString().split("T")[0],isActive:!0});return this.setCurrentUser(r),r}),f(e=>{console.error("Register error:",e);let r="Kay\u0131t s\u0131ras\u0131nda bir hata olu\u015Ftu";return e.error?.message?r=e.error.message:e.status===400?r="Ge\xE7ersiz kullan\u0131c\u0131 bilgileri":e.status===409&&(r="Bu email adresi zaten kullan\u0131mda"),a(()=>new Error(r))}))}logout(){localStorage.removeItem(this.STORAGE_KEY),this.removeToken(),this.currentUserSubject.next(null)}getCurrentUser(){return this.currentUserSubject.value}isLoggedIn(){return this.getCurrentUser()!==null}setCurrentUser(t){localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t)),this.currentUserSubject.next(t)}getToken(){return localStorage.getItem(this.TOKEN_KEY)}removeToken(){localStorage.removeItem(this.TOKEN_KEY)}validatePassword(t){let i=t.length>=8,e=/\d/.test(t),r=/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(t);return i&&e&&r}getUserById(t){let i=o.find(e=>e.id===t);return m(i).pipe(u(300))}updateProfile(t){let i=this.getCurrentUser();if(!i)return a(()=>new Error("Kullan\u0131c\u0131 giri\u015Fi yap\u0131lmam\u0131\u015F"));let e=o.findIndex(r=>r.id===i.id);if(e!==-1){let r=s(s({},o[e]),t);o[e]=r;let h=n(s({},r),{password:""});return this.setCurrentUser(h),m(h).pipe(u(500))}return a(()=>new Error("Kullan\u0131c\u0131 bulunamad\u0131"))}static{this.\u0275fac=function(i){return new(i||l)(g(y))}}static{this.\u0275prov=d({token:l,factory:l.\u0275fac,providedIn:"root"})}}return l})();export{S as a};
